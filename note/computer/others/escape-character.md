<!-- TOC -->

- [转义字符](#转义字符)
    - [ASCII ESC(escape)字符](#ascii-escescape字符)
        - [序列元素（Sequence elements）](#序列元素sequence-elements)
        - [CSI序列](#csi序列)
- [参考](#参考)

<!-- /TOC -->

## 转义字符

转义字符，标志着在一个字符序列中，出现在它后面的几个字符采用一种替代解释，不代表原含义。**转义字符即转义序列开始的那个字符**。

不同的场景，使用的转义字符也不一样，例如
- 最开始使用ASCII中`\x1b, ESC（escape）`字符表示，主要应用早先的外设控制协议
- 后台引申到其它场景
    - c语言中，`\x5c, 反斜杠 \`字符表示
    - URI协议中， `\0x25, 百分号, %`字符表示
    - 通信点对点协议中，`\0x7d`字符表示
    - ...


### ASCII ESC(escape)字符

ASCII的 "escape"字符（八进制\033，十六进制\x1b，十进制27，或^[），作为转义字符，被用于许多输出设备，标志开始一个转义字符序列。

> 编程语言中常使用反斜杠`\`作为转义字符

该转义序列被输出设备（例如终端）提取、并判断、然后调用相关命令解释，从而控制文本、视屏等显示的格式、颜色、其它选项等。

#### 序列元素（Sequence elements）

序列长度不固定，所有序列以字符`ESC`（\0x1b,\033,27）开始，后跟ASCII 64~95范围内`@A-Z[\]^_`的第二个字符。

`ESC` + [`@A-Z[\]^_`] + content: 前两个字符的不同组合，可以表示不同的控制作用

在8位ASCII环境中，使用0x80到0x9F范围中的控制字符，可以将这两个字符可以合并为单字节，但是如果设备规划0x80~0x9F内的字符有其它作用，则不能合并。在7位ASCII环境中当然就只能识别这两个字节的转义字符。

<!-- 在使用UTF-8编码的终端上，两种格式都需要两个字节（UTF-8中的控制序列引导器(Control Sequence Introducer CSI)），`ESC[`序列更加清晰。 -->

大多数序列多于两个字符，并且以`ESC[`开头。在8位系统中，可能提供0x80~0x8F范围内的单个字符`0x98，0233，155`来表示和`ESC[`相同的意义，但是`ESC[`这种两字符序列比单字节还是更常用一些。`ESC[`这种序列称为**CSI**，**Control Sequence Introducer**，**Control Sequence Initiator**。这种序列的最后一个字符在64~126范围内。

<!-- 以转义字符开头的序列称为转义序列（escape sequences），以CSI开头的序列称为控制序列，一个序列可以即使转义序列又是控制序列。 -->

#### CSI序列

`ESC` + [`@A-Z[\]^_`]不同组合中的`ESC` + `[`组合称为CSI，这种组合应用更加广泛，接下来介绍一下。

详细的可以参考[维基百科](https://en.wikipedia.org/wiki/ANSI_escape_code)

这里简单介绍下图形相关的：SGR-Select Graphic Rendition，选择图形渲染。设置SGR参数，包括文本颜色、字体装饰等。CSI码格式为：

`CSI [param] m`

中间的参数param由分号";"隔开，不带参数`CSIm`则默认为`CSI0m`

- 0：重置
- 1：字体加粗、高亮
- 2：低亮
- 3：斜体
- 4：下划线
- 5：闪烁，慢
- 6：闪烁，快
- 7：交换前景、背景
- 8：隐藏文本
- 9：划掉文本
- ...
- 30-37：设置文本颜色，八种基本色
- 38：设置文本颜色，多种颜色，格式为 38;5;n 或 38;2;r;g;b（n，r，g，b的值范围为0~255）
- 40-47:设置文本背景色，八种基本色
- 48：设置文本背景色，多种颜色，格式为 38;5;n 或 38;2;r;g;b（n，r，g，b的值范围为0~255）
- ...

```shell
\x1b[30m
```

## 参考

[WIKI: ANSI_escape_code](https://en.wikipedia.org/wiki/ANSI_escape_code)  
[ASCII](http://ascii-table.com)




