1. 用户名
2. 加密密码
3. 上次更改密码的时间
4. 最小更改密码的间隔
5. 密码的有效期
6. 密码过期提示时间
7. 密码锁定期
8. 帐号有效期
9. 保留字段

# /etc/shadow

## 概要

- */etc/shadow* 文件记录用户帐号的密码信息，以及一些可选的密码时效信息
- 仅被超级用户可读

## 文件格式

- 9项
- 登录名:加密口令:密码最后一次修改时间:密码最小修改间隔:密码有效期:密码过期提示时间:密码不活动:帐号有效期:保留字段
    1. 登录名
    2. 加密口令
        - 如果为空，则用户没有口令，登录不需要口令，但具体情况视具体的操作系统而定，有些系统判断为空，可能也不允许登录
        - 密码字符串的生成详细可以参考库函数 [crypt(3)](http://man7.org/linux/man-pages/man3/crypt.3.html)
        - 如果加密口令含有的字符串不是有效的 crypt(3) 结果，例如 "!" 或 "*"，则用户不允许登录
        - 如果加密口令，以 "!" 开头，则表示该帐号locked，例如 “!$1$5M0Rbozg$1fWsJaQB.TFAL24b96xi41:17043:0:99999:7”，"!" 后面的字符串还是原来的加密密码
        - **注意**：当像"!"、"*"等符号，锁住用户密码时，此时用户不能以帐号密码登录，但是可以使用 公钥秘钥登录、su切换帐号等...
    3. 上一次修改密码的时间
        - 上一次修改密码的时间，表示为1970.1.1后的总天数
    4. 最小修改密码时间间隔
        - 默认为0
        - 天数
        - 两次更改密码的最短间隔时间，如果小于间隔时间内再次修改密码是不被允许的
        - 如果该字段为空或0，表示没有最小时间间隔，即不受限制
    5. 最大修改密码时间间隔（也可以理解为password有效期）
        - 默认为99999
        - 当前密码的有效期，如果到期了密码仍是有效的，只不过用户下次登录时，系统会强制其更改密码
        - 如果该字段为空，则表示没有最大修改密码时间间隔限制、没有密码过期时间、没有不活动时间限制
        - 如果该项小于最小修改时间间隔，则用户不能修改其密码
    6. 密码过期提示时间
        - 默认为7，即密码到期的前7天的时候，就警告提醒用户
    7. 密码不活动时间
        - 默认为空
        - 天数
        - 当用户密码过期后，该密码可登录的有效时间（登录上去，系统会让你强制改密码，可见第5点）
        - 如果用户 密码过期+不活动时间过期，那么用户再也登录不了，需要了解超管了
        - 该字段为空，表示没有“不活动时间”限制
    8. 帐号有效期
        - 默认为空
        - 帐号的有效期（注意不是密码），表示为1970.1.1后的总天数
        - 其有效期过后，用户帐号不允许登录
        - 如果为空，表示帐号永远有效
        - 该值不应该设置为0，因为要么表示帐号无效，获取表示其有效期在1970.1.1，即都不允许登录
        - > 如果帐号到期，使用`su`
    9. 保留字段
        - 默认为空

## 示例

```
root:!:17043:0:99999:7:::
daemon:*:16652:0:99999:7:::
bin:*:16652:0:99999:7:::
sys:*:16652:0:99999:7:::
sync:*:16652:0:99999:7:::
games:*:16652:0:99999:7:::
man:*:16652:0:99999:7:::
lp:*:16652:0:99999:7:::
mail:*:16652:0:99999:7:::
news:*:16652:0:99999:7:::
uucp:*:16652:0:99999:7:::
proxy:*:16652:0:99999:7:::
www-data:*:16652:0:99999:7:::
backup:*:16652:0:99999:7:::
list:*:16652:0:99999:7:::
irc:*:16652:0:99999:7:::
gnats:*:16652:0:99999:7:::
nobody:*:16652:0:99999:7:::
libuuid:!:16652:0:99999:7:::
syslog:*:16652:0:99999:7:::
messagebus:*:16652:0:99999:7:::
usbmux:*:16652:0:99999:7:::
dnsmasq:*:16652:0:99999:7:::
avahi-autoipd:*:16652:0:99999:7:::
kernoops:*:16652:0:99999:7:::
rtkit:*:16652:0:99999:7:::
saned:*:16652:0:99999:7:::
whoopsie:*:16652:0:99999:7:::
speech-dispatcher:!:16652:0:99999:7:::
avahi:*:16652:0:99999:7:::
lightdm:*:16652:0:99999:7:::
colord:*:16652:0:99999:7:::
hplip:*:16652:0:99999:7:::
pulse:*:16652:0:99999:7:::
yaofei:$1$5M0Rbozg$1fWsJaQB.TFAL24b96xi41:17043:0:99999:7:::
sshd:*:17043:0:99999:7:::
mysql:!:17048:0:99999:7:::
```

## 链接

- [man7](http://man7.org/linux/man-pages/man5/shadow.5.html)