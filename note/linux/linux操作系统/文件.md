# linux文件相关

## 文件描述符

文件描述符（File Descriptor, fd），相当于对文件的引用。文件描述符在形式上是一个**非负**整数，实际上，它是一个索引值，指向**内核**为每一个**进程**所维护的该进程打开文件的记录表。当程序打开一个现有文件或创建一个新文件时，内核向进程返回一个fd。在程序设计中，一些涉及底层的程序编写往往会围绕fd展开。但是fd这一概念往往仅适用类UNIX操作系统。

每个Unix进程（除了某些守护进程）应均有三个标准的POSIX文件描述符，对应三个标准流：
- stdin：0
- stdout：1
- stderr：2

> 注意：linux认为文件不仅指实际存储在磁盘上的，而是认为一切皆文件。文件、目录、字符设备、块设备、Socket等都以文件被对待，他们虽然类型不同，但内核对其提供同一套操作接口。

> "一切皆文件"意味着内核对应用层，提供同一套操作接口，所以在应用层看来，它们是一致的，都类似文件操作。而这"同一套接口"主要由内核中[**虚拟文件系统(VFS)**](#)实现，详细可查看VFS概念。

> 文件描述符属于VFS的设计、实现中的重要概念

文件描述符：
- 优点：
    - 基于文件描述符的I/O操作兼容POSIX标准
    - 在类UNIX的系统调用中，大量的系统调用都是依赖于文件描述符
    - 类UNIX系统设计思想视一切设备为文件，因此fd为该系列平台上的编程提供了一个统一的方法。
    - ...
- 缺点：
    - 在非类UNIX系统上，该概念不适用。Windows下的文件描述符、内核对象等记作句柄handle。
    - ...

