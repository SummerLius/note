<!-- TOC -->

- [声明](#声明)
    - [类型说明符](#类型说明符)
        - [存储类型](#存储类型)
            - [变量存储类型](#变量存储类型)
                - [变量性质](#变量性质)
                - [auto存储类型](#auto存储类型)
                - [static存储类型](#static存储类型)
                - [extern存储类型](#extern存储类型)
            - [函数存储类型](#函数存储类型)
        - [类型限定符](#类型限定符)
    - [声明符](#声明符)
    - [初始化](#初始化)
    - [初始化式](#初始化式)
    - [内联函数](#内联函数)
    - [参考](#参考)

<!-- /TOC -->


# 声明

变量和函数必须先声明后使用，声明向编译器提供有关变量和函数的标识符的信息。

声明对象
- 声明变量
- 声明函数

声明格式： **`[声明说明符 声明符]`**：
- `声明说明符`：有以下类型。类型限定符和类型说明符必须在存储类型后面，但两者顺序没有限制，不过一般约定类型限定符置于类型说明符前面。
    - **存储类型**：auto、static、extern和register。声明中最多存在以上一种类型。如果存在，必须置于最前。
    - **类型限定符**：const、volatile、restrict（c99）。声明可以包含零个或多个限定符。
    - **类型说明符**：void、char、int、short、long、float、signed、unsinged、struct、enum、union...等都是类型说明符。还有使用typedef创建的类型名也是。
    - **函数说明符（c99）**：仅一种类型，即inline。
- `声明符`：有以下取值。声明符之前用逗号分隔。表示变量的声明符后边可以跟随初始化式。
    - 标识符
    - 后跟随[]的标识符（数组名）：标识符[]
    - 前放置*的标识符（指针名）：\*标识符
    - 后跟随()的标识符（函数名）：标识符()

示例：
```c
/**
 *
 * extern:   存储类型
 * const：   限定符
 * unsigned: 类型说明符
 * long：    类型说明符
 * int：     类型说明符
 * a[10]：   声明符（后跟随[]的标识符）
 * b：       声明符（前置*标识符）
 * c：       声明符（普通标识符）
 *
 */
extern const unsigned long int a[10],*b,c;
```



<!-- ISO/IEC标准文档目录：
- 英文
    - Storage-class specifiers
    - Type specifiers
    - Type qualifiers
    - Function specifiers
    - Declarators
    - Type names
    - Type definitions
    - Initialization
- 中文
    - 存储说明符
    - 类型说明符
    - 类型修饰符
    - 函数说明符
    - 声明符
    - 类型名称
    - 类型定义
    - 初始化 -->



<!-- 
=== 变量类型

==== 局部变量

1. 函数体内的声明的变量称为该函数的**局部变量**
2. 局部变量性质
    - **自动存储期限**：生命周期随函数
    - **块作用域**
3. 静态局部变量：前面加上static
    - **静态存储期限**：该变量生命周期不随函数，而是整个程序，拥有固定的存储单元
    - **块作用域**
4. 形参局部变量：性质和局部变量一样


==== 外部变量

1. 声明在函数体外的变量称为**外部变量**
2. 外部变量性质
    - **静态存储期限**：如同static声明的局部变量，拥有整个程序的生命周期，有固定的存储单元
    - **文件作用域**：拥有整个**文件的作用域**，从变量被声明的点开始一直到文件的末尾。 
3. 外部变量可以被不同的函数共享，但不要太依赖，不要随意修改共享的外部变量值，不注意的话可能产生错误、冲突。除非指用作只读或const修饰，不过只读的话，也可以使用宏。




==== 存储类型

c程序中每个变量都具体以下3个性质：
1. **存储期限**：决定变量的生命周期。
2. **作用域**：具有块作用域和文本作用域。
3. **链接**：确定程序不同部分可以共享此变量的范围。
    - 外部链接：的变量可以被程序中几个或全部文件共享
    - 内部链接：的变量只属于单独一个文件
    - 无链接：的变量属于单独的一个函数

变量的默认存储期限、作用域和链接都依赖于变量声明的位置：
- 在块：内部声明的变量：auto存储、块作用域、并且无链接
- 程序最外层：声明的的变量：static存储、文本作用域、外部链接

大多数情况下，默认的变量性质就足够了。



变量的存储类型：
1. auto类型存储仅对属于块的变量有效
2. static类型，可以用于全部变量，无需考虑声明位置。但产生效果些许不同
    - 块外部static声明：`static int i`，对比默认，改变了链接：外部->内部
        - 静态存储
        - 文本作用域
        - 内部链接
    - 块内部static声明：`void f(void){ static int j; }`，对比默认，改变了存储：auto->static
        - 静态存储
        - 块作用域
        - 无链接
3. extern类型：使得几个源文件可以共享同一个变量。待定...
4. register类型要求编译器把变量存储在寄存器中，而不像其它保存在内存中。指明存储类型为register，对编译器来说是一种请求，不是命令。该类型，目前不做了解。


函数的存储类型：
1. extern：指定函数具有外部链接
2. static：指定函数具有内部链接

函数默认是extern类型

-->

## 类型说明符

### 存储类型

#### 变量存储类型

##### 变量性质

C程序中每个变量都具有以下3个性质：
- **存储期限**：即生命周期。具有**自动存储期限**的变量，在所属块被执行时获得内存单元，并在块终止时释放内存单元。具有**静态存储期限**的变量，在程序运行期间占有同一块存储单元，即同进程的声明周期一致。
- **作用域**：变量的作用域指可以引用变量的那部分程序文本。两种作用域，**块作用域**（变量声明的地方~所在块的末尾）和**文本作用域**（变量声明的地方~文件的末尾）。
- **链接**：确定了程序的不同部分可以共享此变量的范围。具有**外部链接**的变量可以被程序中几个或全部文件共享；具有**内部链接**的变量只能属于单独一个文件，此文件的函数可以共享这个变量。**无链接**的变量属于单独的一个函数，不能被共享。


变量**默认**的性质依赖与变量声明的位置：
- 块内：自动存储期限、块作用域、无链接
- 程序最外层：静态存储期限、文件作用域、外部链接

一般情况下，变量默认的性质就符合要求了，当无法满足要求时可以指定明确的**存储类型**来改变变量的性质。

##### auto存储类型

auto存储类型只能声明**块变量有效**。如果对最外层变量用auto声明，则编译器会报错。

auto存储类型声明的变量性质：自动存储期限、块作用域、无链接。

auto存储类型几乎不需要显示指定，因为在块内部声明的变量，默认就是auto。

##### static存储类型

static存储类型可以适用全部变量，无论块内外，但是造成的效果不同。
- 作用于块内变量：
    - 静态存储期限
    - 块作用域
    - 无链接
- 作用于块外变量：
    - 静态存储期限
    - 文本作用域
    - 内部链接

static变量有趣一些点：
- **块内static变量只在程序执行前进行一次初始化**（即使该变量所在的块被执行多次），而auto变量则在每次出现时初始化（假设它有初始化式）。下面给出代码示例。
- 每次函数被递归调用时，它都会获得一组新的auto变量。但是函数含有static变量，那么此函数的全部调用都共享这个static变量
- 函数不能返回指向auto变量的指针，但是可以返回指向static变量的指针
- ...

```c
#include <stdio.h>
#include <stdlib.h>

void p() {
    auto int autoValue = 1;
    static int staticValue = 1;

    autoValue++;
    staticValue++;

    printf("auto和static：%d  %d \n", autoValue, staticValue);
}

int main() {
    p();
    p();
    p();
    
    return 0;
}


// 执行结果：
// auto和static：2 2
// auto和static：2 3
// auto和static：2 4


// 结论：函数内（块内）static变量声明时的初始化，仅执行一次，即使之后该函数（块内）多次被调用执行。
```


##### extern存储类型

extern存储类型可以使几个源文件共享同一个变量。

- `extern int i;`：这样的声明不会导致编译器为变量i分配存储单元。



#### 函数存储类型

### 类型限定符

## 声明符

## 初始化

当程序开始执行时，某些变量会被自动设置为0，而大多数变量不会。没有默认值且程序中未被赋值的变量是**未初始化**的。

## 初始化式

## 内联函数

## 参考

- 《c语言程序设计 现代方法 第二版》
- C99标准（ISO/IEC 9899:1999(E)）


